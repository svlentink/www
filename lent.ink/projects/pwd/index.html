<html>
<head>
<script type="text/javascript" src="https://cdn.lent.ink/generated/bower_components/crypto-js/crypto-js.js"></script>
<style>
section {
  width: 550px;
  margin:0 auto;
  padding: 25px;
  margin-bottom: 50px;
  border: 5px solid;
  border-radius: 10px;
  border-bottom: 0;
}
input { width: 350px; }
</style>
</head>
<body>
<section>
<h1>Password generator</h1>
<table>
  <tr>
    <td>
      Prefix:
    </td>
    <td>
      <input id='prefix' value='R!' style='width:30px;'/>
    </td>
  </tr>
  <tr>
    <td>
      <a href='https://www.google.com/search?q=what+is+an+apex+domain'>Apex</a>
    </td>
    <td>
      <input id="apex" value="google.com"/>
    </td>
  </tr>
  <tr>
    <td>
      Secret phrase
    </td>
    <td>
      <input id='secret' value='some long sentence'/>
      <button onclick='eye()'>&#128065;</button>
      <button onclick='save()'>&#x1f4be;</button>
    </td>
  </tr>
  <tr>
    <td></td>
    <td>
      <button onclick='sha1()'>SHA1 (default)</button>
      <button onclick='sha3()'>SHA3</button>
      <button onclick='hmac()'>HMAC</button>
    </td>
  </tr>
  <tr>
    <td>
      Password:
    </td>
    <td>
      <input disabled id='output'/>
    </td>
  </tr>
</table>

<script>
var saved = localStorage.getItem('pwddatastr')
if (saved !== null) {
  document.getElementById('secret').value = saved
  sha1()
}

function sha1(){ generate(function(m,k){return CryptoJS.SHA1(m+k)}) }
function sha3(){ generate(function(m,k){return CryptoJS.SHA3(m+k)}) }
function hmac(){ generate(function(m,k){return CryptoJS.HmacSHA3(m,k)})}
function generate(func) {
  var apex = document.getElementById('apex').value
  var secret = getSecVal()
  var prefix = document.getElementById('prefix').value
  var pwd = prefix + func(apex, secret).toString()
  document.getElementById('output').value = pwd
}
function getSecVal() {
  var secretelem = document.getElementById('secret')
  secretelem.type = 'password'
  return secretelem.value
}
function eye() {
  var e = document.getElementById("secret")
  if(e.type === 'text') return

  e.value = ''
  e.type = 'text'
}
function save() {
  localStorage.setItem('pwddatastr',getSecVal())
  alert('Saved to LocalStorage')
}
</script>
</section>

<section>
<h2>Is it secure?</h2>
The hash generated gives you up to 160bit password strenght,
depending on the passphrase.
Passwords are unique for every website,
since the domain is hashed.
When you create an account at a malicious service,
it is not able to login into any of your other accounts.
<br/>
You could have multiple passphrases,
e.g. one for all work related, one for social media and one for remaining accounts.
<br/>
NOTE: some website have a max length on a password,
this means a lower strenght,
especially since the hash part is
<a href='https://stackoverflow.com/questions/12618321/what-pool-of-characters-do-md5-and-sha-have'>hexadecimal</a>.
But the requirement of max length already indicates that such a service
has bad security.
</section>


<section>
<h2>How does it work?</h2>
It is inspired by
<a href='https://pwdhash.github.io/website/'>Stanford PwdHash</a>
and works by doing
<br/>
<code>echo -n 'apex.tldPASSPHRASE' | shasum</code>
<br/>
It is a concatenation of the domain you want a password for,
together with a phrase that you use.
This string is then used to calculate a hash,
which is your password.
To allow for specific password requirements,
we prefix the hash with a capital letter and a special character
(we picked '!' since it is the first in the
<a href='https://www.asciitable.com'>ASCII table</a>).
We picked 'R' since it is the 18th letter of the alphabet
and we changed the password of this website in 2018.
</section>


<section>
<h2>What about a password manager?</h2>
The motivation for this password manager was the backup requirement
of normal password managers.
This is the main advantage of this solution.
<br/>
Disadvantages compared to password manager;
<ul>
<li>Less bits per char, resulting in weaker passwords when truncated
(max length on password input field)</li>
<li>When your secret sentence is compromized,
one could generate all your passwords
(the same goes for your password on your online password manager)</li>
<li>Your sentence unlocks the power to generate all your passwords,
also the passwords for not yet existing services,
while a password manager only stores the passwords that are actually used</li>
<li>This password mechanism allows one to generate them on the terminal
and other insecure places, which could be a risk</li>
<li>Just like a regular password manager with random passwords,
the password cannot be memorized</li>
<br/>
Other disadvantages;
<li>A key based hash (HMAC) or slow hash (Argon2, [S|B]crypt, PBKDF2)
would make this system more secure,
however,
<code>shasum</code> was chosen,
since it comes pre-installed on most machines</li>

</ul>

</section>

</body>

</html>
